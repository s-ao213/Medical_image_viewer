# DICOM画像ビューア 操作マニュアル

ローカルのDICOMファイルを読み込み、3つの断面（Axial/Sagittal/Coronal）を同時に表示するビューアです。

## 📖 目次

1. [環境構築](#環境構築)
2. [起動方法](#起動方法)
3. [画面構成](#画面構成)
4. [操作方法](#操作方法)
5. [トラブルシューティング](#トラブルシューティング)

## 環境構築

**必須環境**
- Python 3.7 以上

**インストール**

PowerShellで以下のコマンドを実行してください。

```powershell
pip install pydicom numpy matplotlib pillow
```

## 起動方法

PowerShellで以下のコマンドを実行します。

```powershell
python dicom_viewer.py
```

起動すると、フォルダ選択ダイアログが自動的に表示されます。DICOMファイル（.dcm）が保存されているフォルダを選択してください。

## 画面構成

### レイアウト

**画像表示エリア（画面上部）**
- 左側 - Axial画像（横断面、輪切り）
- 右側 - Sagittal または Coronal画像（縦断面）

**情報パネル（画面右側）**

スクロール可能なパネルに以下の情報が表示されます。

*画像情報*
- サイズ（縦×横）
- 枚数
- 厚さ

*患者情報*
- 患者名
- 患者ID
- 性別
- 生年月日
- 年齢
- 検査日
- 検査部位
- モダリティ
- 機器名

**画像調整パネル（画面下部）**

横並びのスライダーで以下を調整できます。
- Axial スライス
- 表示モード（Sagittal / Coronal）
- スライス位置
- Window Width（コントラスト）
- Window Level（明るさ）

### 交差線について

Axial画像上に表示される線は、縦断面の位置を示しています。
- シアン色の縦線 - Sagittal表示時
- 黄色の横線 - Coronal表示時

## 操作方法

### ファイルを開く

ツールバーから3つの方法でファイルを開けます。

**単一ファイル**
1. 「📁 ファイルを開く」をクリック
2. .dcmファイルを選択

**複数ファイル**
1. 「📂 複数ファイルを開く」をクリック
2. Ctrlキーを押しながら複数のファイルを選択

**フォルダ（推奨）**
1. 「📁 フォルダを開く」をクリック
2. フォルダを選択すると、内部の全.dcmファイルが読み込まれます

**キーボードショートカット**
- Ctrl + O - 単一ファイルを開く
- Ctrl + Shift + O - 複数ファイルを開く
- Ctrl + D - フォルダを開く

### 画像の調整

**Window Width（コントラスト調整）**

画像の明暗差を調整します。
- 値を大きく → ぼんやり（全体が見える）
- 値を小さく → はっきり（特定部分が強調）

推奨値
- 初期値 400
- 全体を見る 800-2000
- 細部を見る 200-400

**Window Level（明るさ調整）**

画像の明るさの中心値を調整します。
- 値を大きく → 暗くなる
- 値を小さく → 明るくなる

推奨値
- 初期値 40
- 調整範囲 -1000 〜 1000

**調整手順**
1. Window Levelで明るさを調整（画像が見えるようにする）
2. Window Widthでコントラストを調整（見やすくする）
3. 両方を微調整して最適な表示を探す

## 注意事項

患者情報はDICOMヘッダから取得されます。個人情報の取り扱いには十分注意してください。

## 用語集

**DICOM** - 医療用画像の標準フォーマット

**Axial** - 横断面（体を水平に輪切りにした画像）

**Sagittal** - 矢状断面（体を左右に分ける縦の断面）

**Coronal** - 冠状断面（体を前後に分ける縦の断面）

**Window Width** - 表示するコントラストの幅

**Window Level** - 表示する明るさの中心値

作成日 2025-10-22
| はっきりさせる | 200 | 40 | コントラスト強 |
| 全体を見る | 1000 | 0 | 広範囲が見える |

## よくある質問

### Q1: アプリが起動しません

**確認事項**
1. Pythonがインストールされているか
   ```powershell
   python --version
   ```
2. 必要なライブラリがインストールされているか
   ```powershell
   pip install pydicom numpy matplotlib pillow
   ```
3. 正しいフォルダにいるか（dicom_viewer.pyがある場所）

### Q2: 画像が真っ黒です

**原因** Window Levelが高すぎる

**解決方法**
1. **Window Level スライダーを左に動かす**（値を小さく）
2. 少しずつ動かして、画像が見えるまで調整
3. それでもダメなら、Window Widthを大きく（1000程度）してから再調整

### Q3: 画像が真っ白です

**原因** Window Levelが低すぎる

**解決方法**
1. **Window Level スライダーを右に動かす**（値を大きく）
2. 少しずつ動かして、画像が見えるまで調整

### Q4: ファイルが開けません

**考えられる原因**
1. **DICOMファイルでない** - 拡張子が.dcmでも、中身がDICOMでない場合があります。別のDICOMファイルで試してください
2. **ファイルパスに問題がある** - 日本語が含まれていないか確認。ファイルが存在するか確認
3. **ライブラリのインストール不足**
   ```powershell
   pip install pydicom numpy matplotlib pillow
   ```

### Q5: 複数ファイルを読み込んだが、スライス数が合いません

**原因** 一部のファイルが読み込めなかった可能性

**確認方法**
- 読み込み成功ダイアログに表示される情報を確認
- フォルダ内に.dcmファイルのみがあるか確認

### Q6: 交差線が見えません

**原因** 交差線の色と画像が同化している

**解決方法**
- Window Width/Levelを調整
- 表示モードを切り替えてみる（Sagittal ↔ Coronal）

### Q7: スライダーが動きません

**原因** ファイルが正しく読み込まれていない

**解決方法**
1. ファイルを開き直す
2. 別のDICOMファイルで試す

### Q8: "ModuleNotFoundError" というエラーが出ます

**原因** 必要なライブラリがインストールされていない

**解決方法**
```powershell
pip install pydicom numpy matplotlib pillow
```

## 用語集

### DICOM（ダイコム）
医療用画像の標準フォーマット。CT、MRI、X線などの画像に使用される。

### スライス
3D画像の1枚1枚の断面。例: 50スライス = 50枚の断面画像

### Axial（アキシャル）
横断面。体を水平に輪切りにした画像。上から見た図。

### Sagittal（サジタル）
矢状断面。体を左右に分ける縦の断面。横から見た図。

### Coronal（コロナル）
冠状断面。体を前後に分ける縦の断面。正面から見た図。

### Window Width（ウィンドウ幅）
表示するコントラストの幅。大きい=ぼんやり、小さい=はっきり

### Window Level（ウィンドウレベル）
表示する明るさの中心値。高い=暗い、低い=明るい

### 交差線
Axial画像上に表示される線。他の断面の位置を示す。

## ファイル構成

```
test/
├── dicom_viewer.py           # このプログラムを実行
├── README.md                 # このマニュアル
└── （あなたのDICOMファイル）  # .dcmファイルをここに配置
```

## トラブル時のチェックリスト

アプリが正常に動作しない場合、以下を順番に確認してください:

- [ ] Pythonがインストールされている（`python --version`）
- [ ] ライブラリがインストールされている（`pip list`で確認）
- [ ] DICOMファイルが正しい形式である
- [ ] ファイルパスに日本語や特殊文字が含まれていない
- [ ] dicom_viewer.pyと同じフォルダで実行している

**作成日**: 2025年10月22日  
